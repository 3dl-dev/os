services:
  beads:
    image: baron-os/beads
    build:
      context: .
      dockerfile: Dockerfile.beads
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - ${PROJECT_ROOT:-.}:/workspace
    working_dir: /workspace

  gh:
    image: baron-os/gh
    build:
      context: .
      dockerfile: Dockerfile.gh
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - ${PROJECT_ROOT:-.}:/workspace
      - ${HOME}/.config/gh:/home/ghuser/.config/gh
    environment:
      - HOME=/home/ghuser
    working_dir: /workspace

  api:
    image: baron-os/api
    build:
      context: .
      dockerfile: Dockerfile.api
    user: "${UID:-1000}:${GID:-1000}"
    ports:
      - "${ATOM_API_PORT:-3131}:3131"
    volumes:
      - ${TOOLS_DIR:-.}/api:/app:ro
      - ${PROJECTS_BASE:-/home/baron/projects}:/projects
    environment:
      - PROJECTS_BASE=/projects
      - ATOM_API_TOKEN=${ATOM_API_TOKEN:-}
      - ATOM_API_PORT=3131
    working_dir: /app
